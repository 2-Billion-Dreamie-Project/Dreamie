extends ../../layouts/admin/layout_admin

block title 
  title Danh sách danh mục

block append style
  link(rel='stylesheet', href='/bower_components/datatables.net-bs4/css/dataTables.bootstrap4.min.css')
  link(rel='stylesheet', href='/assets/css/category_admin.min.css')
  

block content
  if messDelCategory && messDelCategory !== ''
    div.mb-4.mess-del
      h5=messDelCategory

  if messUpdateCategory && messUpdateCategory !== ''
    div.mb-4.mess-del
      h5=messUpdateCategory
      
  a.btn.btn-success.mb-3(href="/admin/category/custom-category") Thêm mới
  .table-responsive
    table.table.table-dark.table-bordered.table-hover#category-table
      thead
        tr
          th(scope='col') ID
          th(scope='col') Tên danh mục
          th(scope='col') Ảnh danh mục
          th(scope='col') Thuộc danh mục
          th(scope='col') Ngày sửa
          th(scope='col') Trạng thái
          th(scope='col') Hành động
      tbody
        if categories && categories.length
          each category in categories
            tr
              th(scope='row')=category.id ? category.id : ''
              td=category.name ? category.name : ''
              td
                if category.image && category.image !== ''
                  a(title='Phóng to hình', rel='gallery', href=category.image, data-fancybox='', data-caption=category.name)
                    img(src=category.image)
              td
                if category.isParent === true
                  | Danh mục cha
                else 
                  a=category.childCategoryIds.ObjectId
              
              td=category.updatedAt ? moment(category.updatedAt).format('DD/MM/YYYY HH:mm') : ''
              td=category.status ? category.status : ''
              td
                if category._id
                  a.btn.btn-info.mr-2.mb-xl-0.mb-2(href="/admin/category/custom-category/" + category._id) Xem
                  a.btn.btn-danger(data-toggle="modal", data-target=".delete-alert") Xóa

              .delete-alert.modal.fade(tabindex='-1', role='dialog', aria-labelledby='delete-alert', aria-hidden='true')
                .modal-dialog(role='document')
                  .modal-content                      
                    .modal-body.text-center
                      img(src="/assets/img/icon-warning.png")
                      h6.text-center.mb-3 Xóa vĩnh viễn sẽ không thể phục hồi
                      h4.text-center Bạn chắc chắn muốn xóa chứ ?
                    .modal-footer
                      button.btn.btn-dark(type='button', data-dismiss='modal') Hủy bỏ
                      a.btn.btn-danger(href="/admin/category/delete/" + category._id) Xóa

  script(src='/bower_components/jquery/dist/jquery.min.js')
  script(src='/bower_components/datatables.net/js/jquery.dataTables.min.js')
  script(src='/bower_components/datatables.net-bs4/js/dataTables.bootstrap4.min.js')
  script.
    $(document).ready( function () {
      $('#category-table').DataTable({
        "language": {
          "lengthMenu": "Hiển thị _MENU_ mục",
          "emptyTable":     "Không có dữ liệu nào trong bảng",
          "loadingRecords": "Đang tải...",
          "zeroRecords": "Không có mục nào được tìm thấy",
          "info": "Hiển thị _START_ đến _END_ trong _TOTAL_ mục",
          "infoEmpty": "Không có mục nào có sẵn",
          "infoFiltered": "(Lọc từ _MAX_ mục)",
          "search": "Tìm kiếm:",
          "paginate": {
              "first":      "Đầu",
              "last":       "Cuối",
              "next":       "Sau",
              "previous":   "Trước"
          },
        },
        "order": [[ 0, "desc" ]],
        "pagingType": "full_numbers"
      });
      
    });

